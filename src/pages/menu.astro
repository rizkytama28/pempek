---
import Layout from '../layouts/Layout.astro';
import Header from '../components/Header.astro';
import MenuCard from '../components/MenuCard.astro';
import { supabase } from '../lib/supabase';

// Ambil data menu asli dari Supabase saat halaman di-build
const { data: menus, error } = await supabase
    .from('menus')
    .select('*, categories(name)')
    .order('id', { ascending: true });

---

<Layout title="Menu - Pempek.in">
	<Header />
	<main class="container mx-auto p-4">
		<h1 class="text-4xl font-bold my-8 text-center">Menu Kami</h1>
		
        {error && <p class="text-center text-red-500">Gagal memuat menu: {error.message}</p>}

        {menus && menus.length > 0 ? (
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                {menus.map(item => (
                    <MenuCard item={item} />
                ))}
            </div>
        ) : (
            <p class="text-center text-gray-400">Belum ada menu yang tersedia saat ini.</p>
        )}

	</main>
</Layout>
